(window.webpackJsonp__wix_thunderbolt_app=window.webpackJsonp__wix_thunderbolt_app||[]).push([[112],{219:function(e,t,n){"use strict";n.r(t),n.d(t,"site",(function(){return F})),n.d(t,"editor",(function(){return J})),n.d(t,"TpaHandlersManagerSymbol",(function(){return l.d})),n.d(t,"TpaSectionSymbol",(function(){return l.e})),n.d(t,"name",(function(){return l.g})),n.d(t,"TpaDataCapsuleSymbol",(function(){return l.c})),n.d(t,"MasterPageTpaPropsCacheSymbol",(function(){return l.a})),n.d(t,"TpaSrcBuilderSymbol",(function(){return l.f})),n.d(t,"TpaContextMappingSymbol",(function(){return l.b}));var r=n(400),a=n(413),o=n(0),i=n(26),c=n(401),u=n(135),d=n(13),l=n(221),s=n(257),p=n(246),f=function(e){if(e.data)try{return JSON.parse(e.data)}catch(e){}return{}},g=function(e){return e&&["TPA","TPA2"].includes(e.intent)},m=["getWixUpgradeUrl","stylesReady","getViewModeInternal","setHelpArticle"],b=Object(i.h)([s.a,d.a,l.b,c.d,c.b,u.f,Object(i.g)(p.a)],(function(e,t,n,r,a,i,c){return{appDidMount:function(){e.addWindowMessageHandler({canHandleEvent:function(e){return!(!e.source||!g(f(e)))},handleEvent:function(e){return Object(o.b)(this,void 0,void 0,(function(){var a,u,d,s,p,g,b;return Object(o.d)(this,(function(v){switch(v.label){case 0:return a=f(e),u=a.type,d=a.callId,m.includes(u)?[2]:(s=function(e){var t=e.compId;if(t)return n.getTpaComponentContextId(t)||r.getContextIdOfCompId(t)}(a),p=n.getTpaComponentIdFromTemplate(a.compId),g=null!=p?p:a.compId,b=Object(o.a)(Object(o.a)({},a),{compId:g,origin:e.origin}),c&&c.tpa.addMessage({message:b,compId:g,contextId:s}),s?[4,(h=s,Object(o.b)(void 0,void 0,Promise,(function(){return Object(o.d)(this,(function(e){switch(e.label){case 0:return[4,t(h)];case 1:return[2,e.sent().getAllImplementersOnPageOf(l.d)[0]]}}))})))]:(console.error("TPA handler message caller does not belong to any page",{type:u,callId:d,compId:g}),[2]));case 1:return v.sent().handleMessage(e.source,b).catch((function(e){console.error("HandleTpaMessageError",u,s,g,e),i.captureError(e,{tags:{feature:"tpa",handlerName:u},extra:{handlerName:u,compId:g}})})),[2]}var h}))}))}})}}})),v=n(396),h=Object(i.h)([s.a,l.d,v.d,Object(i.g)(p.a)],(function(e,t,n,r){return setTimeout((function(){e.addWindowMessageHandler({canHandleEvent:function(e){return!(!e.source||!g(f(e)))},handleEvent:function(e){return Object(o.b)(this,void 0,void 0,(function(){var a,i,c;return Object(o.d)(this,(function(o){return a=f(e),i=a.type,c=a.compId,m.includes(i)||(r&&r.tpa.addMessage({message:a,compId:c,contextId:n}),t.handleMessage(e.source,a).catch((function(e){console.error("HandleTpaMessageError",i,n,c,e)}))),[2]}))}))}})}),1e3),{}})),I=n(8),O=n.n(I),y=n(402),j=Object(i.h)([c.b,y.a],(function(e,t){var n={};return{cacheProps:function(t,r){var a=O.a.omitBy(r||e.get(t),O.a.isFunction);n[t]=O.a.isEmpty(a)?null:a},getCachedProps:function(e){var r,a,o,i,c=n[e];if(c)return O.a.isEqual(null===(a=null===(r=t.getCurrentRouteInfo())||void 0===r?void 0:r.dynamicRouteData)||void 0===a?void 0:a.publicData,null===(i=null===(o=t.getPreviousRouterInfo())||void 0===o?void 0:o.dynamicRouteData)||void 0===i?void 0:i.publicData)||delete c.src,c}}})),P=n(217),C=n(545),w=Object(i.h)([Object(i.f)(P.e,l.g),u.b,Object(i.e)(a.c)],(function(e,t,n){var r=e.widgetsClientSpecMapData,a=e.externalBaseUrl,i=e.requestUrl;return{buildSrc:function(e,c,u,d,l){void 0===l&&(l={});var s,p=r[u.widgetId]||{},f=O.a.merge({tpaInnerRouteConfig:null,extraQueryParams:{},appDefinitionId:""},l),g={compId:e,pageId:c,tpaCompData:u,options:f},m=O.a.assign.apply(O.a,Object(o.h)([{}],Object(o.e)(n.map((function(e){return e.getQueryParams(g)}))))),b=f.tpaInnerRouteConfig?function(e,n){var r,c=Boolean(n.tpaPageUri&&!O.a.isNil(p.applicationId)&&p.applicationId===n.tpaApplicationId),u=Object(o.e)(((null==t?void 0:t.location.href)||i).replace(a,"").split("?"),1)[0],d=Object(o.e)(decodeURIComponent(u).split("?"),2),l=d[0],s=d[1],f=c&&Object(C.a)(l,n.tpaPageUri);return f&&(null===(r=p.appPage)||void 0===r?void 0:r.defaultPage)&&f.unshift(p.appPage.defaultPage),f?function(e,t,n){if(0===e.length)return t;var r=e.join("/"),a=new URL(t);(a.pathname+="/"+r,n)&&new URLSearchParams(n).forEach((function(e,t){return a.searchParams.append(t,e)}));return a.href}(f,e,s):e}(d,f.tpaInnerRouteConfig):d;try{(s=new URL(b)).pathname=O.a.trimEnd(s.pathname,"/")}catch(e){return""}return O.a.entries(m).forEach((function(e){var t=Object(o.e)(e,2),n=t[0],r=t[1];O.a.isNil(r)||s.searchParams.set(n,r)})),s.href}}})),T=Object(i.h)([],(function(){var e={},t={};return{registerTpasForContext:function(t,n){n.forEach((function(n){e[n]=t}))},getTpaComponentContextId:function(t){return e[t]},registerTpaTemplateId:function(e,n){t[e]=n},getTpaComponentIdFromTemplate:function(e){return t[e]}}})),D=Object(i.h)([],(function(){var e={},t={};return{registerTpaSection:function(n,r){e[n]=r,t[r.appDefinitionId]=n},unregisterTpaSection:function(n){var r=e[n],a=null==r?void 0:r.appDefinitionId;delete e[n],a&&delete t[a]},getTpaSectionByAppDefinitionId:function(n){var r=t[n];return e[r]}}})),S=n(27),M=n(391),R=n(25),U=n(32),x=Object(i.h)([Object(i.f)(P.e,l.g)],(function(e){return{getQueryParams:function(t){var n=t.compId,r=t.pageId,a=t.tpaCompData,i=t.options.extraQueryParams,c=e.siteRevision,u=e.viewMode,d=e.deviceType,l=e.locale,s=e.tpaDebugParams,p=e.timeZone,f=e.regionalLanguage,g=a.templateId,m=a.externalId,b=a.width,v=a.height;return Object(o.a)(Object(o.a)({pageId:r,compId:g||n,viewerCompId:n,siteRevision:""+c,viewMode:u,deviceType:d,externalId:m,locale:l,tz:p,regionalLanguage:f,width:O.a.isNumber(b)?""+b:null,height:O.a.isNumber(v)?""+v:null},s),i)}}})),E=Object(i.h)([Object(i.f)(P.e,l.g),S.a],(function(e,t){var n=e.widgetsClientSpecMapData;return{getQueryParams:function(e){var r=e.tpaCompData,a=e.options,o=(n[r.widgetId]||{}).appDefinitionId||a.appDefinitionId||"";return{instance:t.getAppInstanceByAppDefId(o)}}}})),_=Object(i.h)([Object(i.f)(P.e,l.g),u.b],(function(e,t){return{getQueryParams:function(){var n,r=e.requestUrl,a=e.extras,o=new URL((null===(n=null==t?void 0:t.location)||void 0===n?void 0:n.href)||r);return{currency:a.currency,currentCurrency:o.searchParams.get("currency")||a.currency}}}})),H=Object(i.h)([M.b],(function(e){var t=e.viewerSessionId;return{getQueryParams:function(){return{vsi:t}}}})),Q=Object(i.h)([R.a],(function(e){return{getQueryParams:function(){var t,n=e.getCurrentConsentPolicy();return{"consent-policy":(t=n).defaultPolicy&&O.a.every(t.policy)||!e._getConsentPolicyHeader()["consent-policy"]?void 0:decodeURIComponent(e._getConsentPolicyHeader()["consent-policy"])}}}})),A=Object(i.h)([U.a],(function(e){return{getQueryParams:function(){return{commonConfig:JSON.stringify(e.getCommonConfigForUrl())}}}})),N=Object(i.h)([y.a],(function(e){return{getQueryParams:function(){var t,n,r=null===(n=null===(t=e.getCurrentRouteInfo())||void 0===t?void 0:t.dynamicRouteData)||void 0===n?void 0:n.publicData;return{routerData:r?JSON.stringify(r):null}}}})),L=Object(i.h)([Object(i.f)(P.e,l.g),c.d,u.b],(function(e,t,n){return{getQueryParams:function(r){var a,i=r.compId,c=r.tpaCompData,u=r.options,d=e.widgetsClientSpecMapData,l=e.appSectionParams,s=e.isMobileView,p=e.requestUrl,f=e.viewMode,g=e.externalBaseUrl,m={target:null,"section-url":null};if(c.widgetId){var b=d[c.widgetId],v=b.widgetUrl,h=b.mobileUrl,I=s&&h||v,O=((null===(a=t.get(i))||void 0===a?void 0:a.componentType)||"").toLowerCase().endsWith("section");c.isSection&&O&&("site"===f?(m["section-url"]=g+"/"+u.tpaInnerRouteConfig.tpaPageUri+"/",m.target="_top"):(m["section-url"]=I,m.target="_self"))}return Object(o.a)(Object(o.a)({},function(){var e;if(n){var t=new URL((null===(e=null==n?void 0:n.location)||void 0===e?void 0:e.href)||p).searchParams.get("appSectionParams");return JSON.parse(decodeURIComponent(t||"{}"))||{}}return l}()),m)}}})),B=Object(i.h)([Object(i.f)(P.e,l.g)],(function(e){var t=e.metaSiteId,r={},a=function(e,t,n){return r[n]},i=function(e,n,a,o){return e.namespace=r[o],e.scope=t,e},c=O.a.once((function(){return Object(o.b)(void 0,void 0,void 0,(function(){return Object(o.d)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([n.e(4),n.e(162)]).then(n.bind(null,802))];case 1:return(new(e.sent().FrameStorageListener)).start(a,i),[2]}}))}))}));return{registerToDataCapsule:function(e,t){c(),r[e]=t},unregister:function(e){delete r[e]}}})),F=function(e){e(r.a.AppDidMountHandler).to(b),e(l.a).to(j),e(l.b).to(T),e(l.f).to(w),e(l.e).to(D),e(a.c).to(x),e(a.c).to(E),e(a.c).to(_),e(a.c).to(H),e(a.c).to(Q),e(a.c).to(A),e(a.c).to(N),e(a.c).to(L),e(l.c).to(B)},J=function(e){e(a.a).to(h),e(l.b).to(T),e(l.f).to(w),e(l.e).to(D),e(a.c).to(x),e(a.c).to(E),e(a.c).to(_),e(a.c).to(A),e(a.c).to(N),e(a.c).to(L)}},545:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(0),a=function(e,t){var n=e.split("/"),a=n.indexOf(t||"");return a<0||n[a]!==t?null:Object(r.e)(n.splice(a)).slice(1)}}}]);
//# sourceMappingURL=https://static.parastorage.com/services/wix-thunderbolt/dist/tpaCommons.6b39a0cb.chunk.min.js.map